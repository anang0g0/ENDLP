<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="境理" />
  <title>半分配環上の公開鍵暗号とその応用</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
  </style>
</head>
<body>
<header id="title-block-header">
<h1 class="title">半分配環上の公開鍵暗号とその応用</h1>
<p class="author">境理</p>
<p class="date">2023年某月某日</p>
</header>
<h1 id="半分配環上の２つの公開鍵暗号とその応用">半分配環上の２つの公開鍵暗号とその応用</h1>
<h2 id="半直積と加法">半直積と加法</h2>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>,</mo><mi>b</mi><mo>,</mo><mi>c</mi></mrow><annotation encoding="application/x-tex">a,b,c</annotation></semantics></math>を素体の元、<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>,</mo><mi>B</mi><mo>,</mo><mi>C</mi></mrow><annotation encoding="application/x-tex">A,B,C</annotation></semantics></math>を楕円曲線上の点とする。</p>
<h3 id="半直積">半直積</h3>
<p>半直積の演算は次のように定義されている。（ここで使うのは外部半直積の定義である。）<br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>A</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="prefix">(</mo><mi>b</mi><mo>,</mo><mi>B</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>a</mi><mi>b</mi><mo>,</mo><mi>b</mi><mi>A</mi><mo>+</mo><mi>B</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(a,A)(b,B)=(ab,bA+B)</annotation></semantics></math></p>
<p>（日本語の本だと<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>A</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="prefix">(</mo><mi>b</mi><mo>,</mo><mi>B</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>a</mi><mi>b</mi><mo>,</mo><mi>a</mi><mi>B</mi><mo>+</mo><mi>A</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(a,A)(b,B)=(ab,aB+A)</annotation></semantics></math>という記法をしているようだが、左右反対になるだけで基本は同じ。つまり、<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><mi>b</mi><mo>,</mo><mi>B</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>A</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>a</mi><mi>b</mi><mo>,</mo><mi>a</mi><mi>B</mi><mo>+</mo><mi>A</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(b,B)(a,A)=(ab,aB+A)</annotation></semantics></math>である。）</p>
<p>また、半直積にはベクトル同士の積がないように加法が定義されていない。<br />
そこで加法を次にように定義する。<br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>A</mi><mo stretchy="false" form="postfix">)</mo><mo>+</mo><mo stretchy="false" form="prefix">(</mo><mi>b</mi><mo>,</mo><mi>B</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>a</mi><mo>+</mo><mi>b</mi><mo>,</mo><mi>A</mi><mo>+</mo><mi>B</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(a,A)+(b,B)=(a+b,A+B)</annotation></semantics></math><br />
普通に直和です。 以下ではこのような代数系が環であるかどうか確かめる。</p>
<h2 id="環の条件">環の条件</h2>
<pre><code>１）加法に関して結合律を満たす。  </code></pre>
<h3 id="結合律">結合律</h3>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><mo stretchy="false" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>A</mi><mo stretchy="false" form="postfix">)</mo><mo>+</mo><mo stretchy="false" form="prefix">(</mo><mi>b</mi><mo>,</mo><mi>B</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo><mo>+</mo><mo stretchy="false" form="prefix">(</mo><mi>c</mi><mo>,</mo><mi>C</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>a</mi><mo>+</mo><mi>b</mi><mo>,</mo><mi>A</mi><mo>+</mo><mi>B</mi><mo stretchy="false" form="postfix">)</mo><mo>+</mo><mo stretchy="false" form="prefix">(</mo><mi>c</mi><mo>,</mo><mi>C</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>a</mi><mo>+</mo><mi>b</mi><mo>+</mo><mi>c</mi><mo>,</mo><mi>A</mi><mo>+</mo><mi>B</mi><mo>+</mo><mi>C</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">((a,A)+(b,B))+(c,C)=(a+b,A+B)+(c,C)=(a+b+c,A+B+C)</annotation></semantics></math> <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>A</mi><mo stretchy="false" form="postfix">)</mo><mo>+</mo><mo stretchy="false" form="prefix">(</mo><mo stretchy="false" form="prefix">(</mo><mi>b</mi><mo>,</mo><mi>B</mi><mo stretchy="false" form="postfix">)</mo><mo>+</mo><mo stretchy="false" form="prefix">(</mo><mi>c</mi><mo>,</mo><mi>C</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>A</mi><mo stretchy="false" form="postfix">)</mo><mo>+</mo><mo stretchy="false" form="prefix">(</mo><mi>b</mi><mo>+</mo><mi>c</mi><mo>,</mo><mi>B</mi><mo>+</mo><mi>C</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>a</mi><mo>+</mo><mi>b</mi><mo>+</mo><mi>c</mi><mo>,</mo><mi>A</mi><mo>+</mo><mi>B</mi><mo>+</mo><mi>C</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(a,A)+((b,B)+(c,C))=(a,A)+(b+c,B+C)=(a+b+c,A+B+C)</annotation></semantics></math><br />
よって成り立つ。</p>
<h3 id="零元の存在">零元の存在</h3>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>A</mi><mo stretchy="false" form="postfix">)</mo><mo>+</mo><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo>,</mo><mi>O</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo>,</mo><mi>O</mi><mo stretchy="false" form="postfix">)</mo><mo>+</mo><mo stretchy="false" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>A</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>A</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(a,A)+(0,O)=(0,O)+(a,A)=(a,A)</annotation></semantics></math><br />
よって存在する。</p>
<h3 id="逆元の存在">逆元の存在</h3>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mo stretchy="false" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>A</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mo>−</mo><mi>a</mi><mo>,</mo><mo>−</mo><mi>A</mi><mo stretchy="false" form="postfix">)</mo><mo>+</mo><mo stretchy="false" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>A</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>A</mi><mo stretchy="false" form="postfix">)</mo><mo>+</mo><mo stretchy="false" form="prefix">(</mo><mo>−</mo><mi>a</mi><mo>,</mo><mo>−</mo><mi>A</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo>,</mo><mi>O</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">-(a,A)=(-a,-A)+(a,A)=(a,A)+(-a,-A)=(0,O)</annotation></semantics></math><br />
となり、存在する。</p>
<h3 id="可換律">可換律</h3>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>A</mi><mo stretchy="false" form="postfix">)</mo><mo>+</mo><mo stretchy="false" form="prefix">(</mo><mi>b</mi><mo>,</mo><mi>B</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>b</mi><mo>,</mo><mi>B</mi><mo stretchy="false" form="postfix">)</mo><mo>+</mo><mo stretchy="false" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>A</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>a</mi><mo>+</mo><mi>b</mi><mo>,</mo><mi>A</mi><mo>+</mo><mi>B</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(a,A)+(b,B)=(b,B)+(a,A)=(a+b,A+B)</annotation></semantics></math><br />
よって成り立つ。</p>
<p>全て成り立つので、この演算は加法群である。</p>
<p>以下、環の条件を確かめる。</p>
<pre><code>２）結合則を満足する  </code></pre>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>A</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="prefix">(</mo><mi>b</mi><mo>,</mo><mi>B</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="prefix">(</mo><mi>c</mi><mo>,</mo><mi>C</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>a</mi><mi>b</mi><mo>,</mo><mi>b</mi><mi>A</mi><mo>+</mo><mi>B</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="prefix">(</mo><mi>c</mi><mo>,</mo><mi>C</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>a</mi><mi>b</mi><mi>c</mi><mo>,</mo><mi>c</mi><mo stretchy="false" form="prefix">(</mo><mi>b</mi><mi>A</mi><mo>+</mo><mi>B</mi><mo stretchy="false" form="postfix">)</mo><mo>+</mo><mi>C</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>a</mi><mi>b</mi><mi>c</mi><mo>,</mo><mi>b</mi><mi>c</mi><mi>A</mi><mo>+</mo><mi>c</mi><mi>B</mi><mo>+</mo><mi>C</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(a,A)(b,B)(c,C)= (ab,bA+B)(c,C)=(abc,c(bA+B)+C)=(abc,bcA+cB+C)</annotation></semantics></math><br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>A</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="prefix">(</mo><mi>b</mi><mi>c</mi><mo>,</mo><mi>c</mi><mi>B</mi><mo>+</mo><mi>C</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>a</mi><mi>b</mi><mi>c</mi><mo>,</mo><mi>b</mi><mi>c</mi><mi>A</mi><mo>+</mo><mi>c</mi><mi>B</mi><mo>+</mo><mi>C</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(a,A)(bc,cB+C)=(abc,bcA+cB+C)</annotation></semantics></math></p>
<p>よって満足する。</p>
<pre><code>３）乗法単位 e が存在する  </code></pre>
<p>単位元<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">e=(1,0)</annotation></semantics></math>とすると、<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>A</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="prefix">(</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>A</mi><mo>+</mo><mn>0</mn><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mo stretchy="false" form="prefix">(</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>A</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>a</mi><mo>,</mo><mn>0</mn><mo>+</mo><mi>A</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(a,A)(1,0)=(a,A+0),(1,0)(a,A)=(a,0+A)</annotation></semantics></math> となるので、<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>e</mi><annotation encoding="application/x-tex">e</annotation></semantics></math>は乗法単位元である。</p>
<pre><code>４）分配律を満足する  </code></pre>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>A</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="prefix">(</mo><mo stretchy="false" form="prefix">(</mo><mi>b</mi><mo>,</mo><mi>B</mi><mo stretchy="false" form="postfix">)</mo><mo>+</mo><mo stretchy="false" form="prefix">(</mo><mi>c</mi><mo>,</mo><mi>C</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>A</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="prefix">(</mo><mi>b</mi><mo>+</mo><mi>c</mi><mo>,</mo><mi>B</mi><mo>+</mo><mi>C</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>a</mi><mi>b</mi><mo>+</mo><mi>a</mi><mi>c</mi><mo>,</mo><mo stretchy="false" form="prefix">(</mo><mi>b</mi><mo>+</mo><mi>c</mi><mo stretchy="false" form="postfix">)</mo><mi>A</mi><mo>+</mo><mi>B</mi><mo>+</mo><mi>C</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(a,A)((b,B)+(c,C))=(a,A)(b+c,B+C)=(ab+ac,(b+c)A+B+C)</annotation></semantics></math><br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><mo stretchy="false" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>A</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="prefix">(</mo><mi>b</mi><mo>,</mo><mi>B</mi><mo stretchy="false" form="postfix">)</mo><mo>+</mo><mo stretchy="false" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>A</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="prefix">(</mo><mi>c</mi><mo>,</mo><mi>C</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>a</mi><mi>b</mi><mo>,</mo><mi>b</mi><mi>A</mi><mo>+</mo><mi>B</mi><mo stretchy="false" form="postfix">)</mo><mo>+</mo><mo stretchy="false" form="prefix">(</mo><mi>a</mi><mi>c</mi><mo>,</mo><mi>c</mi><mi>A</mi><mo>+</mo><mi>C</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>a</mi><mi>b</mi><mo>+</mo><mi>a</mi><mi>c</mi><mo>,</mo><mo stretchy="false" form="prefix">(</mo><mi>b</mi><mo>+</mo><mi>c</mi><mo stretchy="false" form="postfix">)</mo><mi>A</mi><mo>+</mo><mi>B</mi><mo>+</mo><mi>C</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">((a,A)(b,B)+(a,A)(c,C))=(ab,bA+B)+(ac,cA+C)=(ab+ac,(b+c)A+B+C)</annotation></semantics></math></p>
<p>から積を計算するのと、積を計算してから足した結果が一致するので、左分配法則が成り立つ。</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><mo stretchy="false" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>A</mi><mo stretchy="false" form="postfix">)</mo><mo>+</mo><mo stretchy="false" form="prefix">(</mo><mi>b</mi><mo>,</mo><mi>B</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="prefix">(</mo><mi>c</mi><mo>,</mo><mi>C</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>a</mi><mo>+</mo><mi>b</mi><mo>,</mo><mi>A</mi><mo>+</mo><mi>B</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="prefix">(</mo><mi>c</mi><mo>,</mo><mi>C</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>c</mi><mo stretchy="false" form="prefix">(</mo><mi>a</mi><mo>+</mo><mi>b</mi><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mi>c</mi><mo stretchy="false" form="prefix">(</mo><mi>A</mi><mo>+</mo><mi>B</mi><mo stretchy="false" form="postfix">)</mo><mo>+</mo><mi>C</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>a</mi><mi>c</mi><mo>+</mo><mi>b</mi><mi>c</mi><mo>,</mo><mi>c</mi><mo stretchy="false" form="prefix">(</mo><mi>A</mi><mo>+</mo><mi>B</mi><mo stretchy="false" form="postfix">)</mo><mo>+</mo><mi>C</mi><mo stretchy="false" form="postfix">)</mo><mo>≠</mo></mrow><annotation encoding="application/x-tex">((a,A)+(b,B))(c,C)=(a+b,A+B)(c,C)=(c(a+b),c(A+B)+C)= (ac+bc,c(A+B)+C) \neq</annotation></semantics></math><br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><mo stretchy="false" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>A</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="prefix">(</mo><mi>c</mi><mo>,</mo><mi>C</mi><mo stretchy="false" form="postfix">)</mo><mo>+</mo><mo stretchy="false" form="prefix">(</mo><mi>b</mi><mo>,</mo><mi>B</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="prefix">(</mo><mi>c</mi><mo>,</mo><mi>C</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>a</mi><mi>c</mi><mo>,</mo><mi>c</mi><mi>A</mi><mo>+</mo><mi>C</mi><mo stretchy="false" form="postfix">)</mo><mo>+</mo><mo stretchy="false" form="prefix">(</mo><mi>b</mi><mi>c</mi><mo>,</mo><mi>c</mi><mi>B</mi><mo>+</mo><mi>C</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>a</mi><mi>c</mi><mo>+</mo><mi>b</mi><mi>c</mi><mo>,</mo><mi>c</mi><mo stretchy="false" form="prefix">(</mo><mi>A</mi><mo>+</mo><mi>B</mi><mo stretchy="false" form="postfix">)</mo><mo>+</mo><mn>2</mn><mi>C</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">((a,A)(c,C)+(b,B)(c,C))=(ac,cA+C)+(bc,cB+C)=(ac+bc,c(A+B)+2C)</annotation></semantics></math></p>
<p>なので右分配法則が成り立たない数学からの物体X。積が特殊だからかも。<br />
<strong>つまり環ではない！</strong></p>
<pre><code>半群</code></pre>
<p>半群とは、１つの演算に対して結合法則を満たす代数系である。</p>
<pre><code>半分配環</code></pre>
<p>更に、積に対して半群を成し、かつ加法に関して群を成す代数系であり、分配法則が左右のどちらか1つだけ成り立つ代数系を半分配環と言う。</p>
<p><strong>しかし今、この代数系は０でない全ての元に逆元が存在する。</strong><br />
その場合を、以下で定義する。</p>
<pre><code>半分配体（逆元の存在）</code></pre>
<p>０以外の全ての元に対して逆元が存在する場合、半分配環の一部としてこの代数系を半分配体という<br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>A</mi><msup><mo stretchy="false" form="postfix">)</mo><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>=</mo><mo stretchy="false" form="prefix">(</mo><msup><mi>a</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>,</mo><mo>−</mo><msup><mi>a</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>A</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(a,A)^{-1}=(a^{-1},-a^{-1}A)</annotation></semantics></math>なので、<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>A</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="prefix">(</mo><msup><mi>a</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>,</mo><mo>−</mo><msup><mi>a</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>A</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mn>1</mn><mo>,</mo><mi>O</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(a,A)(a^{-1},-a^{-1}A)=(1,O)</annotation></semantics></math><br />
単位元は<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><mn>1</mn><mo>,</mo><mi>O</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(1,O)</annotation></semantics></math>となる。</p>
<h1 id="結論">結論</h1>
<p>・半直積に加法を導入すると半分配環になった。<br />
・なぜかヒル暗号に使われている。何故秘密鍵暗号なのか？？？</p>
<p>半直積に楕円曲線を使って、それに加法群を導入したら左分配法則しか満たさない半分配環になったというお話。<br />
それでもきちんと動いているのは分配則を使ってないから。</p>
<p>結合則だけを使う分には問題なし。</p>
<h1 id="半分配環と公開鍵暗号">半分配環と公開鍵暗号</h1>
<p>半分配環は半分配体を含む、より大きな代数系である。 この代数系にある1つの元を３つの元に分割する問題を定義して、公開鍵暗号を構成する。</p>
<h2 id="目的">目的</h2>
<p>最初、群の問題に基づく暗号を作るうえで可換群は研究しつくされて、もうこれ以上新しい問題は出てこないと思ったので非可換群に焦点を絞った。 しかし自分が知っている範囲で非可換群は少なくて、大抵、行列に還元されてしまうものであった。 そこでUshakovらの研究の中で半直積というものがあると知り、詳しく調べてみると２つの群を組み合わせて新しい群を作る方法だと分かった。 しかも半直積は非可換だ。</p>
<p>というわけで半直積の材料に有限体と楕円曲線の群を組み合わせて作った代数系が今までのプラットフォームだった。 まだ物足りない、何かできないだろうか？ そこで新たに加法群の構造を取り入れて、その代数系は環の性質を満たすだろうか、と思い付きで試したところ分配法則が成り立たないことがわかった。</p>
<p>さあ、これはおかしいおかしいと分配法則が成り立たない代数系の例を調べてみたら奇跡的に半分配環の記事を見つけて、 そこでようやくこの<strong>数学からの物体Xの正体は半分配体だ</strong>とわかったというわけです。</p>
<p>この先ペアリング写像なども取り入れて、新型を強化していきたいと思います。</p>
<p>これはどちらの材料も加法に関して群になっていたからできたというだけで、例えば置換群だと成り立ちません。 しかしまだ多項式という選択肢があります。例えば有限体上定義された１変数多項式<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>f</mi><annotation encoding="application/x-tex">f</annotation></semantics></math>と有限体の元<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>とのペアを考えます。 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><mi>f</mi><mo>,</mo><msub><mi>x</mi><mn>0</mn></msub><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="prefix">(</mo><mi>g</mi><mo>,</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>f</mi><mi>g</mi><mo>,</mo><mi>g</mi><mo stretchy="false" form="prefix">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo stretchy="false" form="postfix">)</mo><mo>+</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(f,x_0)(g,x_1)=(fg,g(x_0)+x_1)</annotation></semantics></math>であり、更に加法＋を次のように定義する。 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><mi>f</mi><mo>,</mo><msub><mi>x</mi><mn>0</mn></msub><mo stretchy="false" form="postfix">)</mo><mo>+</mo><mo stretchy="false" form="prefix">(</mo><mi>g</mi><mo>,</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>f</mi><mo>+</mo><mi>g</mi><mo>,</mo><msub><mi>x</mi><mn>0</mn></msub><mo>+</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(f,x_0)+(g,x_1)=(f+g,x_0+x_1)</annotation></semantics></math></p>
<p>これはこれで全く問題がないように見えます。 これに関する記事は後日追加します。</p>
<h2 id="準備">準備</h2>
<p>半直積の基本演算を定義すると、</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><mi>c</mi><mo>,</mo><mi>s</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="prefix">(</mo><mi>d</mi><mo>,</mo><mi>t</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>c</mi><mi>d</mi><mo>,</mo><mi>s</mi><mi>d</mi><mo>+</mo><mi>t</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(c,s)(d,t)=(cd,sd+t)</annotation></semantics></math>：積<br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><mi>c</mi><mo>,</mo><mi>s</mi><msup><mo stretchy="false" form="postfix">)</mo><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>=</mo><mo stretchy="false" form="prefix">(</mo><msup><mi>c</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>,</mo><mo>−</mo><mi>s</mi><msup><mi>c</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(c,s)^{-1}=(c^{-1},-sc^{-1})</annotation></semantics></math>：逆元<br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><mi>c</mi><mo>,</mo><mi>s</mi><msup><mo stretchy="false" form="postfix">)</mo><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false" form="prefix">(</mo><mi>d</mi><mo>,</mo><mi>t</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="prefix">(</mo><mi>c</mi><mo>,</mo><mi>s</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>d</mi><mo>,</mo><mi>s</mi><mo stretchy="false" form="prefix">(</mo><mi>e</mi><mo>−</mo><mi>d</mi><mo stretchy="false" form="postfix">)</mo><mo>+</mo><mi>t</mi><mi>c</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(c,s)^{-1}(d,t)(c,s)=(d,s(e-d)+tc)</annotation></semantics></math>：共役元<br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><mi>c</mi><mo>,</mo><mi>s</mi><msup><mo stretchy="false" form="postfix">)</mo><mi>n</mi></msup><mo>=</mo><mo stretchy="false" form="prefix">(</mo><msup><mi>c</mi><mi>n</mi></msup><mo>,</mo><msup><mi>c</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msup><mi>s</mi><mo>+</mo><msup><mi>c</mi><mrow><mi>n</mi><mo>−</mo><mn>2</mn></mrow></msup><mi>s</mi><mo>+</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>+</mo><mi>c</mi><mi>s</mi><mo>+</mo><mi>s</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(c,s)^n=(c^n,c^{n-1}s+c^{n-2}s+...+cs+s)</annotation></semantics></math>：べき乗公式</p>
<p>ここで<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>項等比数列の総和が<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mi>n</mi></msub><mo>=</mo><mfrac><mrow><mo stretchy="false" form="prefix">(</mo><msup><mi>c</mi><mi>n</mi></msup><mo>−</mo><mn>1</mn><mo stretchy="false" form="postfix">)</mo></mrow><mrow><mi>c</mi><mo>−</mo><mn>1</mn></mrow></mfrac></mrow><annotation encoding="application/x-tex">S_n=\frac{(c^n-1)}{c-1}</annotation></semantics></math>から、</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><mi>c</mi><mo>,</mo><mi>s</mi><msup><mo stretchy="false" form="postfix">)</mo><mi>n</mi></msup><mo>=</mo><mo stretchy="false" form="prefix">(</mo><msup><mi>c</mi><mi>n</mi></msup><mo>,</mo><mfrac><mrow><msup><mi>c</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>−</mo><mn>1</mn></mrow><mrow><mi>c</mi><mo>−</mo><mn>1</mn></mrow></mfrac><mi>s</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(c,s)^n=(c^n,\frac{c^{n-1}-1}{c-1}s)</annotation></semantics></math><br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><mi>c</mi><mo>,</mo><mi>s</mi><msup><mo stretchy="false" form="postfix">)</mo><mrow><mi>n</mi><mi>m</mi></mrow></msup><mo>=</mo><mo stretchy="false" form="prefix">(</mo><msup><mi>c</mi><mi>n</mi></msup><mo>,</mo><mfrac><mrow><msup><mi>c</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>−</mo><mn>1</mn></mrow><mrow><mi>c</mi><mo>−</mo><mn>1</mn></mrow></mfrac><mi>s</mi><msup><mo stretchy="false" form="postfix">)</mo><mi>m</mi></msup><mo>=</mo><mo stretchy="false" form="prefix">(</mo><msup><mi>c</mi><mi>n</mi></msup><mo>,</mo><mi>s</mi><mi>′</mi><msup><mo stretchy="false" form="postfix">)</mo><mi>m</mi></msup><mo>=</mo><mo stretchy="false" form="prefix">(</mo><msup><mi>c</mi><mrow><mi>n</mi><mi>m</mi></mrow></msup><mo>,</mo><mfrac><mrow><msup><mi>c</mi><mrow><mi>m</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>−</mo><mn>1</mn></mrow><mrow><mi>c</mi><mo>−</mo><mn>1</mn></mrow></mfrac><mi>s</mi><mi>′</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(c,s)^{nm}=(c^n,\frac{c^{n-1}-1}{c-1}s)^{m}=(c^{n},s&#39;)^m= (c^{nm},\frac{c^{m-1}-1}{c-1}s&#39;)</annotation></semantics></math><br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><mi>c</mi><mo>,</mo><mi>s</mi><msup><mo stretchy="false" form="postfix">)</mo><mrow><mi>m</mi><mo>+</mo><mi>n</mi></mrow></msup><mo>=</mo><mo stretchy="false" form="prefix">(</mo><msup><mi>c</mi><mrow><mi>m</mi><mo>+</mo><mi>n</mi></mrow></msup><mo>,</mo><msup><mi>c</mi><mi>m</mi></msup><mfrac><mrow><msup><mi>c</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>−</mo><mn>1</mn></mrow><mrow><mi>c</mi><mo>−</mo><mn>1</mn></mrow></mfrac><mi>s</mi><mo>+</mo><mfrac><mrow><msup><mi>c</mi><mrow><mi>m</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>−</mo><mn>1</mn></mrow><mrow><mi>c</mi><mo>−</mo><mn>1</mn></mrow></mfrac><mi>s</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(c,s)^{m+n}=(c^{m+n},c^m\frac{c^{n-1}-1}{c-1}s+\frac{c^{m-1}-1}{c-1}s)</annotation></semantics></math></p>
<h1 id="半分配環と半分配体">半分配環と半分配体</h1>
<p>半分配環とは、代数系における加法と乗法の２つの演算のうち、乗法における分配法則が左右いずれかの１つのみに限られているような代数系を指す。<br />
半分配環の性質に、逆元の存在を付け合せたものが半分配体である。<br />
楕円曲線と有限体から半直積を使って新たな乗法群を構成し、更にこの代数系に加群の構造を導入して得られた半分配体上で、離散対数問題と元の３分割問題を定義し、その暗号へ応用について述べる。</p>
<h2 id="例１">例１</h2>
<p>定義：原始根<br />
「<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>は素数であるとする。巡回群<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>Z</mi><mi>p</mi><mo>*</mo></msubsup><annotation encoding="application/x-tex">Z^*_p</annotation></semantics></math>の生成元<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>g</mi><annotation encoding="application/x-tex">g</annotation></semantics></math>は<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>Z</mi><mi>p</mi><mo>*</mo></msubsup><annotation encoding="application/x-tex">Z^*_p</annotation></semantics></math>の原始根(primitive root)またはmodulo p　の原始根と呼ばれる。」</p>
<p>秘密鍵：<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo>,</mo><mi>t</mi><mo>,</mo><mi>u</mi><mo>,</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo>∈</mo><msub><mi>Z</mi><mi>p</mi></msub><mo>,</mo><mi>B</mi><mo>∈</mo><mi>E</mi><mo>,</mo><mi>s</mi><mo>&gt;</mo><mi>u</mi><mo>,</mo><mi>x</mi><mo>&gt;</mo><mi>z</mi></mrow><annotation encoding="application/x-tex">s,t,u,x,y,z \in Z_p,B \in E,s &gt; u, x &gt; z</annotation></semantics></math><br />
公開鍵：<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>,</mo><mi>C</mi><mo>,</mo><mi>D</mi><mo>,</mo><mi>E</mi><mo>∈</mo><mi>E</mi><mo>,</mo><mi>D</mi><mo>=</mo><msup><mi>A</mi><mi>s</mi></msup><msup><mi>B</mi><mi>t</mi></msup><msup><mi>C</mi><mi>u</mi></msup><mo>,</mo><mi>E</mi><mo>=</mo><msup><mi>A</mi><mi>x</mi></msup><msup><mi>B</mi><mi>y</mi></msup><msup><mi>C</mi><mi>z</mi></msup></mrow><annotation encoding="application/x-tex">A,C,D,E \in E,D=A^sB^tC^u,E=A^xB^yC^z</annotation></semantics></math><br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>,</mo><mi>q</mi><mo>,</mo><mi>r</mi><mo>∈</mo><msub><mi>Z</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">p,q,r \in Z_p</annotation></semantics></math> の異なる原始根。<br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo>,</mo><mi>Q</mi><mo>,</mo><mi>R</mi><mo>∈</mo><mi>E</mi></mrow><annotation encoding="application/x-tex">P,Q,R \in E</annotation></semantics></math>　は同じ楕円曲線上の異なる位数の点。<br />
つまり、<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo>,</mo><mi>P</mi><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mi>B</mi><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>q</mi><mo>,</mo><mi>Q</mi><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mi>C</mi><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>r</mi><mo>,</mo><mi>R</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">A=(p,P),B=(q,Q),C=(r,R)</annotation></semantics></math>である。</p>
<p>・ある数<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>g</mi><annotation encoding="application/x-tex">g</annotation></semantics></math>が原始根かどうかを確かめる方法<br />
定義体がソフィー・ジェルマン素数であれば、<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo>−</mo><mn>1</mn><mo>=</mo><mn>2</mn><mo>*</mo><mi>Q</mi></mrow><annotation encoding="application/x-tex">P-1=2*Q</annotation></semantics></math>(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Q</mi><annotation encoding="application/x-tex">Q</annotation></semantics></math>は素数)と表せるので、次の条件を満たすかどうかで原始根かどうか判定することができる。</p>
<p>判定法：ある整数<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>が原始根であるとき、<br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>P</mi><mo>−</mo><mn>1</mn><mo stretchy="false" form="postfix">)</mo><mi>/</mi><mn>2</mn></mrow></msup><mo>mod</mo><mi>P</mi><mo>≠</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">x^{(P-1)/2} \bmod P \neq 1</annotation></semantics></math><br />
かつ、<br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mn>2</mn></msup><mo>mod</mo><mi>P</mi><mo>≠</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">x^{2} \bmod P \neq 1</annotation></semantics></math><br />
これが安全素数に対する原始根の判定条件になります。</p>
<p>例えば、定義体<br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo>=</mo><mn>115792089237316195423570985008687919879869678752368678225506334468897341715723</mn></mrow><annotation encoding="application/x-tex">P=115792089237316195423570985008687919879869678752368678225506334468897341715723</annotation></semantics></math><br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mn>2</mn><mo>,</mo><mi>q</mi><mo>=</mo><mn>4</mn><mo>,</mo><mi>r</mi><mo>=</mo><mn>6</mn></mrow><annotation encoding="application/x-tex">p=2,q=4,r=6</annotation></semantics></math>の場合を考えると、 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>4</mn><annotation encoding="application/x-tex">4</annotation></semantics></math>は原始根ではなく、<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>,</mo><mn>6</mn></mrow><annotation encoding="application/x-tex">2,6</annotation></semantics></math>は原始根である。</p>
<h2 id="暗号１">暗号１</h2>
<p>ケーリーハミルトン攻撃を考慮した行列暗号のつもり。←これを半直積に置き換える。</p>
<p>秘密鍵:<br />
整数 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>,</mo><mi>b</mi><mo>,</mo><mi>c</mi><mo>,</mo><mi>d</mi></mrow><annotation encoding="application/x-tex">a,b,c,d</annotation></semantics></math><br />
ただし、 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>≠</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">a \neq b</annotation></semantics></math><br />
素体の元と素体上で定義された楕円曲線上の点との半直積<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math><br />
公開鍵:<br />
上と同じ半直積の元、<br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>X</mi><annotation encoding="application/x-tex">X</annotation></semantics></math>,<br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>=</mo><msup><mi>X</mi><mi>a</mi></msup><msup><mi>A</mi><mi>c</mi></msup><msup><mi>X</mi><mrow><mo>−</mo><mi>a</mi></mrow></msup></mrow><annotation encoding="application/x-tex">Y = X^a A^c X^{-a}</annotation></semantics></math>,<br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi><mo>=</mo><msup><mi>X</mi><mi>b</mi></msup><msup><mi>A</mi><mrow><mi>c</mi><mi>d</mi></mrow></msup><msup><mi>X</mi><mrow><mo>−</mo><mi>b</mi></mrow></msup></mrow><annotation encoding="application/x-tex">Z = X^b A^{cd} X^{-b}</annotation></semantics></math>,<br />
暗号化:<br />
M: 平文、 r,s: 乱数<br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mn>1</mn><mo>=</mo><msup><mi>X</mi><mi>r</mi></msup><msup><mi>Y</mi><mi>s</mi></msup><msup><mi>X</mi><mrow><mo>−</mo><mi>r</mi></mrow></msup></mrow><annotation encoding="application/x-tex">C1 = X^r Y^s X^{-r}</annotation></semantics></math><br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mn>2</mn><mo>=</mo><msup><mi>X</mi><mi>r</mi></msup><msup><mi>Z</mi><mi>s</mi></msup><msup><mi>X</mi><mrow><mo>−</mo><mi>r</mi></mrow></msup></mrow><annotation encoding="application/x-tex">C2 = X^r Z^s X^{-r}</annotation></semantics></math><br />
暗号文(C1, C2 * M)</p>
<p>復号: <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mn>1</mn><mo>=</mo><msup><mi>X</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>r</mi><mo>+</mo><mi>a</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup><msup><mi>A</mi><mrow><mi>s</mi><mi>c</mi></mrow></msup><msup><mi>X</mi><mrow><mo>−</mo><mo stretchy="false" form="prefix">(</mo><mi>r</mi><mo>+</mo><mi>a</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">C1 = X^{(r+a)} A^{sc} X^{-(r+a)}</annotation></semantics></math><br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mn>2</mn><mo>=</mo><msup><mi>X</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>r</mi><mo>+</mo><mi>b</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup><msup><mi>A</mi><mrow><mi>s</mi><mi>c</mi><mi>d</mi></mrow></msup><msup><mi>X</mi><mrow><mo>−</mo><mo stretchy="false" form="prefix">(</mo><mi>r</mi><mo>+</mo><mi>b</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">C2 = X^{(r+b)} A^{scd} X^{-(r+b)}</annotation></semantics></math><br />
より、<br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mn>2</mn><mo>=</mo><msup><mi>X</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>b</mi><mo>−</mo><mi>a</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup><mi>C</mi><msup><mn>1</mn><mi>d</mi></msup><msup><mi>X</mi><mrow><mo>−</mo><mo stretchy="false" form="prefix">(</mo><mi>b</mi><mo>−</mo><mi>a</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">C2 = X^{(b-a)} C1^d X^{-(b-a)}</annotation></semantics></math><br />
C2*M に、上で求めたC2の逆元を掛けて M を得る。</p>
<h2 id="暗号２半分配体上の離散対数問題乗法に関する">暗号２：半分配体上の離散対数問題（乗法に関する）</h2>
<p>秘密鍵：<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo>,</mo><mi>t</mi><mo>,</mo><mi>u</mi><mo>,</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo>∈</mo><msub><mi>Z</mi><mi>p</mi></msub><mo>,</mo><mi>B</mi><mo>∈</mo><mi>E</mi><mo>,</mo><mi>s</mi><mo>&gt;</mo><mi>u</mi><mo>,</mo><mi>x</mi><mo>&gt;</mo><mi>z</mi></mrow><annotation encoding="application/x-tex">s,t,u,x,y,z \in Z_p,B \in E,s &gt; u, x &gt; z</annotation></semantics></math><br />
公開鍵：<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>,</mo><mi>C</mi><mo>,</mo><mi>D</mi><mo>,</mo><mi>E</mi><mo>∈</mo><mi>E</mi><mo>,</mo><mi>D</mi><mo>=</mo><msup><mi>A</mi><mi>s</mi></msup><msup><mi>B</mi><mi>t</mi></msup><msup><mi>C</mi><mi>u</mi></msup><mo>,</mo><mi>E</mi><mo>=</mo><msup><mi>A</mi><mi>x</mi></msup><msup><mi>B</mi><mi>y</mi></msup><msup><mi>C</mi><mi>z</mi></msup></mrow><annotation encoding="application/x-tex">A,C,D,E \in E,D=A^sB^tC^u,E=A^xB^yC^z</annotation></semantics></math><br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>,</mo><mi>q</mi><mo>,</mo><mi>r</mi><mo>∈</mo><msub><mi>Z</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">p,q,r \in Z_p</annotation></semantics></math> の異なる原始元。<br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo>,</mo><mi>Q</mi><mo>,</mo><mi>R</mi><mo>∈</mo><mi>E</mi></mrow><annotation encoding="application/x-tex">P,Q,R \in E</annotation></semantics></math>　は同じ楕円曲線上の異なる位数の点。<br />
つまり、半直積に使う元、<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>,</mo><mi>B</mi><mo>,</mo><mi>C</mi></mrow><annotation encoding="application/x-tex">A,B,C</annotation></semantics></math>は、それぞれ有限体の元<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>,</mo><mi>q</mi><mo>,</mo><mi>r</mi></mrow><annotation encoding="application/x-tex">p,q,r</annotation></semantics></math>と楕円曲線の異なる点<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo>,</mo><mi>Q</mi><mo>,</mo><mi>R</mi></mrow><annotation encoding="application/x-tex">P,Q,R</annotation></semantics></math>とを任意に取り、<br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo>,</mo><mi>P</mi><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mi>B</mi><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>q</mi><mo>,</mo><mi>Q</mi><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mi>C</mi><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>r</mi><mo>,</mo><mi>R</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">A=(p,P),B=(q,Q),C=(r,R)</annotation></semantics></math><br />
である。</p>
<p><strong>定義：原始根</strong><br />
「<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>は素数であるとする。巡回群<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>Z</mi><mi>p</mi><mo>*</mo></msubsup><annotation encoding="application/x-tex">Z^*_p</annotation></semantics></math>の生成元<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>g</mi><annotation encoding="application/x-tex">g</annotation></semantics></math>は<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>Z</mi><mi>p</mi><mo>*</mo></msubsup><annotation encoding="application/x-tex">Z^*_p</annotation></semantics></math>の原始根(primitive root)またはmodulo p　の原始根と呼ばれる。」</p>
<p>秘密鍵：<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo>,</mo><mi>t</mi><mo>,</mo><mi>u</mi><mo>,</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo>∈</mo><msub><mi>Z</mi><mi>p</mi></msub><mo>,</mo><mi>B</mi><mo>∈</mo><mi>E</mi><mo>,</mo><mi>s</mi><mo>&gt;</mo><mi>u</mi><mo>,</mo><mi>x</mi><mo>&gt;</mo><mi>z</mi></mrow><annotation encoding="application/x-tex">s,t,u,x,y,z \in Z_p,B \in E,s &gt; u, x &gt; z</annotation></semantics></math><br />
公開鍵：<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>,</mo><mi>C</mi><mo>,</mo><mi>D</mi><mo>,</mo><mi>E</mi><mo>∈</mo><mi>E</mi><mo>,</mo><mi>D</mi><mo>=</mo><msup><mi>A</mi><mi>s</mi></msup><msup><mi>B</mi><mi>t</mi></msup><msup><mi>C</mi><mi>u</mi></msup><mo>,</mo><mi>E</mi><mo>=</mo><msup><mi>A</mi><mi>x</mi></msup><msup><mi>B</mi><mi>y</mi></msup><msup><mi>C</mi><mi>z</mi></msup></mrow><annotation encoding="application/x-tex">A,C,D,E \in E,D=A^sB^tC^u,E=A^xB^yC^z</annotation></semantics></math><br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>,</mo><mi>q</mi><mo>,</mo><mi>r</mi><mo>∈</mo><msub><mi>Z</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">p,q,r \in Z_p</annotation></semantics></math> の異なる原始根。<br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo>,</mo><mi>Q</mi><mo>,</mo><mi>R</mi><mo>∈</mo><mi>E</mi></mrow><annotation encoding="application/x-tex">P,Q,R \in E</annotation></semantics></math>　は同じ楕円曲線上の異なる位数の点。<br />
つまり、<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo>,</mo><mi>P</mi><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mi>B</mi><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>q</mi><mo>,</mo><mi>Q</mi><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mi>C</mi><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>r</mi><mo>,</mo><mi>R</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">A=(p,P),B=(q,Q),C=(r,R)</annotation></semantics></math>である。</p>
<p>・ある数<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>g</mi><annotation encoding="application/x-tex">g</annotation></semantics></math>が原始根かどうかを確かめる方法<br />
定義体がソフィー・ジェルマン素数であれば、<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo>−</mo><mn>1</mn><mo>=</mo><mn>2</mn><mo>*</mo><mi>Q</mi></mrow><annotation encoding="application/x-tex">P-1=2*Q</annotation></semantics></math>(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Q</mi><annotation encoding="application/x-tex">Q</annotation></semantics></math>は素数)と表せるので、次の条件を満たすかどうかで原始根かどうか判定することができる。</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mi>′</mi><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo>,</mo><mi>P</mi><msup><mo stretchy="false" form="postfix">)</mo><mi>s</mi></msup><mo stretchy="false" form="prefix">(</mo><mi>q</mi><mo>,</mo><mi>Q</mi><msup><mo stretchy="false" form="postfix">)</mo><mi>t</mi></msup><mo stretchy="false" form="prefix">(</mo><mi>r</mi><mo>,</mo><mi>R</mi><msup><mo stretchy="false" form="postfix">)</mo><mi>u</mi></msup><mo>=</mo><mo stretchy="false" form="prefix">(</mo><msup><mi>p</mi><mi>s</mi></msup><msup><mi>q</mi><mi>t</mi></msup><msup><mi>r</mi><mi>u</mi></msup><mo>,</mo><msup><mi>q</mi><mi>t</mi></msup><msup><mi>r</mi><mi>u</mi></msup><mfrac><mrow><msup><mi>p</mi><mrow><mi>s</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>−</mo><mn>1</mn></mrow><mrow><mi>p</mi><mo>−</mo><mn>1</mn></mrow></mfrac><mi>P</mi><mo>+</mo><msup><mi>r</mi><mi>u</mi></msup><mi>Q</mi><mo>+</mo><mfrac><mrow><msup><mi>r</mi><mrow><mi>u</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>−</mo><mn>1</mn></mrow><mrow><mi>r</mi><mo>−</mo><mn>1</mn></mrow></mfrac><mi>R</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">D&#39;=(p,P)^s(q,Q)^t(r,R)^u=(p^sq^tr^u,q^tr^u\frac{p^{s-1}-1}{p-1}P+r^uQ+\frac{r^{u-1}-1}{r-1}R)</annotation></semantics></math><br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mi>′</mi><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo>,</mo><mi>P</mi><msup><mo stretchy="false" form="postfix">)</mo><mi>x</mi></msup><mo stretchy="false" form="prefix">(</mo><mi>q</mi><mo>,</mo><mi>Q</mi><msup><mo stretchy="false" form="postfix">)</mo><mi>y</mi></msup><mo stretchy="false" form="prefix">(</mo><mi>r</mi><mo>,</mo><mi>R</mi><msup><mo stretchy="false" form="postfix">)</mo><mi>z</mi></msup><mo>=</mo><mo stretchy="false" form="prefix">(</mo><msup><mi>p</mi><mi>x</mi></msup><msup><mi>q</mi><mi>y</mi></msup><msup><mi>r</mi><mi>z</mi></msup><mo>,</mo><msup><mi>q</mi><mi>y</mi></msup><msup><mi>r</mi><mi>z</mi></msup><mfrac><mrow><msup><mi>p</mi><mrow><mi>x</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>−</mo><mn>1</mn></mrow><mrow><mi>p</mi><mo>−</mo><mn>1</mn></mrow></mfrac><mi>P</mi><mo>+</mo><msup><mi>r</mi><mi>z</mi></msup><mi>Q</mi><mo>+</mo><mfrac><mrow><msup><mi>r</mi><mrow><mi>z</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>−</mo><mn>1</mn></mrow><mrow><mi>r</mi><mo>−</mo><mn>1</mn></mrow></mfrac><mi>R</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">E&#39;=(p,P)^x(q,Q)^y(r,R)^z=(p^xq^yr^z,q^yr^z\frac{p^{x-1}-1}{p-1}P+r^zQ+\frac{r^{z-1}-1}{r-1}R)</annotation></semantics></math></p>
<p>この半直積の左側成分は通常の多元離散対数問題であり、右側は楕円曲線の多元離散対数問題である。<br />
２つの異なる原始根を使った離散対数問題は、「多元離散対数問題（Multiple Discrete Logarithm Problem）」と呼ばれます。これは、異なる原始根に対する離散対数を求める問題です。</p>
<p>暗号文：<br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mn>1</mn><mo>=</mo><msup><mi>A</mi><mi>r</mi></msup><mi>D</mi><msup><mi>C</mi><mrow><mi>r</mi><mi>′</mi></mrow></msup><mo>=</mo><msup><mi>A</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>s</mi><mo>+</mo><mi>r</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup><mi>B</mi><msup><mi>C</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>u</mi><mo>+</mo><mi>r</mi><mi>′</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">C1=A^rDC^{r&#39;}=A^{(s+r)}BC^{(u+r&#39;)}</annotation></semantics></math><br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mn>2</mn><mo>=</mo><msup><mi>A</mi><mi>r</mi></msup><mi>E</mi><msup><mi>C</mi><mrow><mi>r</mi><mi>′</mi></mrow></msup><mo>=</mo><msup><mi>A</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>+</mo><mi>r</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup><mi>B</mi><msup><mi>C</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>z</mi><mo>+</mo><mi>r</mi><mi>′</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">C2=A^rEC^{r&#39;}=A^{(x+r)}BC^{(z+r&#39;)}</annotation></semantics></math></p>
<p>復号<br />
アリスは<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo>−</mo><mi>x</mi><mo>,</mo><mi>u</mi><mo>−</mo><mi>z</mi></mrow><annotation encoding="application/x-tex">s-x,u-z</annotation></semantics></math>を知っているので以下を計算できる。<br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>=</mo><msup><mi>A</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>s</mi><mo>−</mo><mi>x</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup><mi>C</mi><mn>2</mn><msup><mi>C</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>u</mi><mo>−</mo><mi>z</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup><mo>=</mo><msup><mi>A</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>+</mo><mi>r</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup><mi>B</mi><msup><mi>C</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>+</mo><mi>r</mi><mi>′</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup><mo>=</mo><mi>C</mi><mn>1</mn></mrow><annotation encoding="application/x-tex">X=A^{(s-x)}C2C^{(u-z)}=A^{(x+r)}BC^{(y+r&#39;)}=C1</annotation></semantics></math></p>
<p>暗号化に関する指数にはなんの制約もないので、むしろこっちの設定のほうが自然だと思います。秘密鍵が増えるということ以外、特に問題はなさそうです。</p>
<p>この暗号は一見して難しそうに見えます。<br />
というのも右要素も左要素も構造が複雑だからです。<br />
2つ以上の原始根、それも2つ以上の秘密指数がある場合には、互いに混ざり合ってしまうので、単純には計算できません。これはもう少し論文を理解する必要があるので簡単には言い切れないですが、解読ができてもできなくても、ここで公開する予定です。<br />
原始根<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>q</mi><annotation encoding="application/x-tex">q</annotation></semantics></math>は秘密鍵であり、更に両側の原始根を秘密指数でべき乗しているので簡単には指数を計算できません。ただ、<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>,</mo><mi>r</mi></mrow><annotation encoding="application/x-tex">p,r</annotation></semantics></math>は小さなサイズの原始根、<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>q</mi><annotation encoding="application/x-tex">q</annotation></semantics></math>は大きなサイズの原始根であるとします。<br />
ただ左半分は、右の楕円曲線を計算するためのものであって、楕円曲線の521bit以上の大きさにはなりません。そして見たことのない3つの原始根の離散対数問題になっています。<br />
これが解ければ楕円半直積の離散指数も分かるということなので、この暗号の安全性は半直積の離散対数問題にある可能性が濃くなります。<br />
素数<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>,</mo><mi>q</mi><mo>,</mo><mi>r</mi></mrow><annotation encoding="application/x-tex">p,q,r</annotation></semantics></math>がそれぞれ異なる原始根であることから、簡単な指数関数としてみることもできません。<br />
同じような方式がないか調べる必要があります。（それが今日多元離散対数問題であるということが解った）</p>
<h3 id="暗号文解析">暗号文解析：</h3>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>=</mo><msup><mi>A</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>−</mo><mi>z</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup><mi>C</mi><mn>2</mn><msup><mi>C</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>−</mo><mi>w</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup><mo>=</mo><msup><mi>A</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>+</mo><mi>r</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup><mi>B</mi><msup><mi>C</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>+</mo><mi>r</mi><mi>′</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup><mo>=</mo><mo stretchy="false" form="prefix">(</mo><msup><mi>p</mi><mrow><mi>x</mi><mo>+</mo><mi>r</mi><mi>′</mi></mrow></msup><mi>q</mi><msup><mi>r</mi><mrow><mi>y</mi><mo>+</mo><mi>r</mi><mi>′</mi></mrow></msup><mo>,</mo><mi>q</mi><msup><mi>r</mi><mrow><mi>y</mi><mo>+</mo><mi>r</mi><mi>′</mi></mrow></msup><mfrac><mrow><msup><mi>p</mi><mrow><mi>x</mi><mo>+</mo><mi>r</mi><mi>′</mi></mrow></msup><mo>−</mo><mn>1</mn></mrow><mrow><mi>p</mi><mo>−</mo><mn>1</mn></mrow></mfrac><mi>P</mi><mo>+</mo><msup><mi>r</mi><mrow><mi>y</mi><mo>+</mo><mi>r</mi><mi>′</mi></mrow></msup><mi>Q</mi><mo>+</mo><mfrac><mrow><msup><mi>r</mi><mrow><mi>y</mi><mo>+</mo><mi>r</mi><mi>′</mi></mrow></msup><mo>−</mo><mn>1</mn></mrow><mrow><mi>r</mi><mo>−</mo><mn>1</mn></mrow></mfrac><mi>R</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">X=A^{(x-z)}C2C^{(y-w)}=A^{(x+r)}BC^{(y+r&#39;)}=(p^{x+r&#39;}qr^{y+r&#39;},qr^{y+r&#39;}\frac{p^{x+r&#39;}-1}{p-1}P+r^{y+r&#39;}Q+\frac{r^{y+r&#39;}-1}{r-1}R)</annotation></semantics></math></p>
<p>暗号文は最終的にこの形に収まります。<br />
この暗号の計算には、楕円曲線の点の素数位数<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>を使います。<br />
行列の場合、未知変数が2つだったから解読できただけで4つにしたら安全だったのかもしれません。<br />
暗号化に使う点のスカラー倍は半直積のべき乗で等比級数の総和で決まりますが、これは半直席の特徴です。<br />
この点のスカラー倍は、秘密指数が分からなければ決定できないので、ここはやはり半直積の離散対数に依存していると言えるような気がします。<br />
暗号文から秘密鍵や平文の情報が漏れているようには見えません。<br />
行列じゃないからケーリーハミルトンも使えないし、総合してみると、<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>,</mo><mi>C</mi></mrow><annotation encoding="application/x-tex">A,C</annotation></semantics></math>を公開しても全く問題がなさそうなので、早速実装してみました。</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>P</mi><mo>,</mo><msub><mi>g</mi><mi>i</mi></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(y,P,g_i)</annotation></semantics></math>が公開パラメータとして、素数<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>P</mi><annotation encoding="application/x-tex">P</annotation></semantics></math>、互いに素な<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>個の原始元<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>g</mi><mi>i</mi></msub><annotation encoding="application/x-tex">g_i</annotation></semantics></math>、<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>個の秘密指数<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mi>i</mi></msub><annotation encoding="application/x-tex">x_i</annotation></semantics></math>があった時、<br />
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><msubsup><mi>Σ</mi><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mi>n</mi></msubsup><msubsup><mi>g</mi><mi>i</mi><msub><mi>x</mi><mi>i</mi></msub></msubsup></mrow><annotation encoding="application/x-tex">y=\Sigma^n_{i=0}g_i^{x_i}</annotation></semantics></math> <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>,</mo><mi>P</mi><mo>,</mo><msub><mi>g</mi><mi>i</mi></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(y,P,g_i)</annotation></semantics></math>から<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo>,</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><msub><mi>x</mi><mi>n</mi></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(x_0,x_1,...,x_n)</annotation></semantics></math>を求める問題を（加法的）多元離散対数問題：(Additive Multi Discrete Logarithm Problem)と呼ぼう。</p>
<p>ベクトル同士の積が定義されてないように、半直積の和も定義次第でどうにかなりそうな気がするが、どうすれば矛盾なく計算できるのか、或いは左側だけ演算を変えることができるのか、しばらく時間が必要である。<br />
もしこれがうまく行けば、難しい問題になる可能性あり。</p>
<h2 id="暗号３離散対数問題に加法を定義する">暗号３：離散対数問題に加法を定義する</h2>
<p>ここで、半直積同士に加法を定義してみる。つまり、<br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo>,</mo><mi>P</mi><mo stretchy="false" form="postfix">)</mo><mo>+</mo><mo stretchy="false" form="prefix">(</mo><mi>q</mi><mo>,</mo><mi>Q</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo>+</mo><mi>q</mi><mo>,</mo><mi>P</mi><mo>+</mo><mi>Q</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(p,P)+(q,Q)=(p+q,P+Q)</annotation></semantics></math><br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>A</mi><msup><mo stretchy="false" form="postfix">)</mo><mi>n</mi></msup><mo>+</mo><mo stretchy="false" form="prefix">(</mo><mi>b</mi><mo>,</mo><mi>B</mi><msup><mo stretchy="false" form="postfix">)</mo><mi>m</mi></msup><mo>=</mo><mo stretchy="false" form="prefix">(</mo><msup><mi>a</mi><mi>n</mi></msup><mo>+</mo><msup><mi>b</mi><mi>m</mi></msup><mo>,</mo><mfrac><mrow><msup><mi>a</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>−</mo><mn>1</mn></mrow><mrow><mi>a</mi><mo>−</mo><mn>1</mn></mrow></mfrac><mi>A</mi><mo>+</mo><mfrac><mrow><msup><mi>b</mi><mrow><mi>m</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>−</mo><mn>1</mn></mrow><mrow><mi>b</mi><mo>−</mo><mn>1</mn></mrow></mfrac><mi>B</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(a,A)^n+(b,B)^m=(a^n+b^m,\frac{a^{n-1}-1}{a-1}A+\frac{b^{m-1}-1}{b-1}B)</annotation></semantics></math><br />
よって、加法に関しては、可換である。<br />
逆元は、<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>A</mi><msup><mo stretchy="false" form="postfix">)</mo><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mo>−</mo><mi>a</mi><mo>,</mo><mo>−</mo><mi>A</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(a,A)^{-1}=(-a,-A)</annotation></semantics></math>である。</p>
<h2 id="定義多元離散対数問題加法と乗法に関する">定義：多元離散対数問題（加法と乗法に関する）</h2>
<p>1st stepと同じように材料を定義する。<br />
秘密鍵：<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo>,</mo><mi>t</mi><mo>,</mo><mi>u</mi><mo>,</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo>∈</mo><msub><mi>Z</mi><mi>p</mi></msub><mo>,</mo><mi>B</mi><mo>∈</mo><mi>E</mi><mo>,</mo><mi>s</mi><mo>&gt;</mo><mi>u</mi><mo>,</mo><mi>x</mi><mo>&gt;</mo><mi>z</mi></mrow><annotation encoding="application/x-tex">s,t,u,x,y,z \in Z_p,B \in E,s &gt; u, x &gt; z</annotation></semantics></math><br />
公開鍵：<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>,</mo><mi>C</mi><mo>,</mo><mi>D</mi><mo>,</mo><mi>E</mi><mo>∈</mo><mi>E</mi><mo>,</mo><mi>D</mi><mo>=</mo><msup><mi>A</mi><mi>s</mi></msup><msup><mi>B</mi><mi>t</mi></msup><msup><mi>C</mi><mi>u</mi></msup><mo>,</mo><mi>E</mi><mo>=</mo><msup><mi>A</mi><mi>x</mi></msup><msup><mi>B</mi><mi>y</mi></msup><msup><mi>C</mi><mi>z</mi></msup></mrow><annotation encoding="application/x-tex">A,C,D,E \in E,D=A^sB^tC^u,E=A^xB^yC^z</annotation></semantics></math><br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>,</mo><mi>q</mi><mo>,</mo><mi>r</mi><mo>∈</mo><msub><mi>Z</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">p,q,r \in Z_p</annotation></semantics></math> の異なる原始元。<br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo>,</mo><mi>Q</mi><mo>,</mo><mi>R</mi><mo>∈</mo><mi>E</mi></mrow><annotation encoding="application/x-tex">P,Q,R \in E</annotation></semantics></math>　は同じ楕円曲線上の異なる位数の点。<br />
つまり、半直積に使う元、<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>,</mo><mi>B</mi><mo>,</mo><mi>C</mi></mrow><annotation encoding="application/x-tex">A,B,C</annotation></semantics></math>は、それぞれ有限体の元<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>,</mo><mi>q</mi><mo>,</mo><mi>r</mi></mrow><annotation encoding="application/x-tex">p,q,r</annotation></semantics></math>と楕円曲線の異なる点<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo>,</mo><mi>Q</mi><mo>,</mo><mi>R</mi></mrow><annotation encoding="application/x-tex">P,Q,R</annotation></semantics></math>とを任意に取り、<br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo>,</mo><mi>P</mi><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mi>B</mi><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>q</mi><mo>,</mo><mi>Q</mi><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mi>C</mi><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>r</mi><mo>,</mo><mi>R</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">A=(p,P),B=(q,Q),C=(r,R)</annotation></semantics></math><br />
である。</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><mi>c</mi><mo>,</mo><mi>s</mi><msup><mo stretchy="false" form="postfix">)</mo><mi>n</mi></msup><mo>=</mo><mo stretchy="false" form="prefix">(</mo><msup><mi>c</mi><mi>n</mi></msup><mo>,</mo><mfrac><mrow><msup><mi>c</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>−</mo><mn>1</mn></mrow><mrow><mi>c</mi><mo>−</mo><mn>1</mn></mrow></mfrac><mi>s</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(c,s)^n=(c^n,\frac{c^{n-1}-1}{c-1}s)</annotation></semantics></math></p>
<p>であるから、公開鍵を<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mo>,</mo><mi>E</mi></mrow><annotation encoding="application/x-tex">D,E</annotation></semantics></math>とすると、<br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo>,</mo><mi>P</mi><msup><mo stretchy="false" form="postfix">)</mo><mi>s</mi></msup><mo>+</mo><mo stretchy="false" form="prefix">(</mo><mi>q</mi><mo>,</mo><mi>Q</mi><msup><mo stretchy="false" form="postfix">)</mo><mi>t</mi></msup><mo>+</mo><mo stretchy="false" form="prefix">(</mo><mi>r</mi><mo>,</mo><mi>R</mi><msup><mo stretchy="false" form="postfix">)</mo><mi>u</mi></msup><mo>=</mo><mo stretchy="false" form="prefix">(</mo><msup><mi>p</mi><mi>s</mi></msup><mo>+</mo><msup><mi>q</mi><mi>t</mi></msup><mo>+</mo><msup><mi>r</mi><mi>u</mi></msup><mo>,</mo><mfrac><mrow><msup><mi>p</mi><mrow><mi>s</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>−</mo><mn>1</mn></mrow><mrow><mi>p</mi><mo>−</mo><mn>1</mn></mrow></mfrac><mi>P</mi><mo>+</mo><mfrac><mrow><msup><mi>q</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>−</mo><mn>1</mn></mrow><mrow><mi>q</mi><mo>−</mo><mn>1</mn></mrow></mfrac><mi>Q</mi><mo>+</mo><mfrac><mrow><msup><mi>r</mi><mrow><mi>u</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>−</mo><mn>1</mn></mrow><mrow><mi>r</mi><mo>−</mo><mn>1</mn></mrow></mfrac><mi>R</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">D=(p,P)^s+(q,Q)^t+(r,R)^u=(p^s+q^t+r^u,\frac{p^{s-1}-1}{p-1}P+\frac{q^{t-1}-1}{q-1}Q+\frac{r^{u-1}-1}{r-1}R)</annotation></semantics></math><br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo>,</mo><mi>P</mi><msup><mo stretchy="false" form="postfix">)</mo><mi>x</mi></msup><mo>+</mo><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo>,</mo><mi>P</mi><msup><mo stretchy="false" form="postfix">)</mo><mi>s</mi></msup><mo>+</mo><mo stretchy="false" form="prefix">(</mo><mi>q</mi><mo>,</mo><mi>Q</mi><msup><mo stretchy="false" form="postfix">)</mo><mi>t</mi></msup><mo>+</mo><mo stretchy="false" form="prefix">(</mo><mi>r</mi><mo>,</mo><mi>R</mi><msup><mo stretchy="false" form="postfix">)</mo><mi>u</mi></msup><mo>+</mo><mo stretchy="false" form="prefix">(</mo><mi>r</mi><mo>,</mo><mi>R</mi><msup><mo stretchy="false" form="postfix">)</mo><mi>y</mi></msup><mo>=</mo><mo stretchy="false" form="prefix">(</mo><msup><mi>p</mi><mi>x</mi></msup><mo>+</mo><msup><mi>p</mi><mi>s</mi></msup><mo>+</mo><msup><mi>q</mi><mi>t</mi></msup><mo>+</mo><msup><mi>r</mi><mi>u</mi></msup><mo>+</mo><msup><mi>r</mi><mi>y</mi></msup><mo>,</mo><mo stretchy="false" form="prefix">(</mo><mfrac><mrow><msup><mi>p</mi><mrow><mi>x</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>−</mo><mn>1</mn></mrow><mrow><mi>p</mi><mo>−</mo><mn>1</mn></mrow></mfrac><mo>+</mo><mfrac><mrow><msup><mi>p</mi><mrow><mi>s</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>−</mo><mn>1</mn></mrow><mrow><mi>p</mi><mo>−</mo><mn>1</mn></mrow></mfrac><mo stretchy="false" form="postfix">)</mo><mi>P</mi><mo>+</mo><mfrac><mrow><msup><mi>q</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>−</mo><mn>1</mn></mrow><mrow><mi>q</mi><mo>−</mo><mn>1</mn></mrow></mfrac><mi>Q</mi><mo>+</mo><mo stretchy="false" form="prefix">(</mo><mfrac><mrow><msup><mi>q</mi><mrow><mi>y</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>−</mo><mn>1</mn></mrow><mrow><mi>q</mi><mo>−</mo><mn>1</mn></mrow></mfrac><mo>+</mo><mfrac><mrow><msup><mi>r</mi><mrow><mi>u</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>−</mo><mn>1</mn></mrow><mrow><mi>r</mi><mo>−</mo><mn>1</mn></mrow></mfrac><mo stretchy="false" form="postfix">)</mo><mi>R</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">E=(p,P)^x+(p,P)^s+(q,Q)^t+(r,R)^u+(r,R)^y=(p^x+p^{s}+q^t+r^{u}+r^y,(\frac{p^{x-1}-1}{p-1}+\frac{p^{s-1}-1}{p-1})P+\frac{q^{t-1}-1}{q-1}Q+(\frac{q^{y-1}-1}{q-1}+\frac{r^{u-1}-1}{r-1})R)</annotation></semantics></math></p>
<p>暗号文：<br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mn>1</mn><mo>=</mo><msup><mi>A</mi><mi>r</mi></msup><mo>+</mo><mi>D</mi><mo>+</mo><msup><mi>C</mi><mrow><mi>r</mi><mi>′</mi></mrow></msup><mo>=</mo><msup><mi>A</mi><mi>r</mi></msup><mo>+</mo><msup><mi>A</mi><mi>s</mi></msup><mo>+</mo><msup><mi>B</mi><mi>t</mi></msup><mo>+</mo><msup><mi>C</mi><mi>u</mi></msup><mo>+</mo><msup><mi>C</mi><mrow><mi>r</mi><mi>′</mi></mrow></msup></mrow><annotation encoding="application/x-tex">C1=A^r+D+C^{r&#39;}=A^{r}+A^s+B^t+C^u+C^{r&#39;}</annotation></semantics></math><br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mn>2</mn><mo>=</mo><msup><mi>A</mi><mi>r</mi></msup><mo>+</mo><mi>E</mi><mo>+</mo><msup><mi>C</mi><mrow><mi>r</mi><mi>′</mi></mrow></msup><mo>=</mo><msup><mi>A</mi><mi>r</mi></msup><mo>+</mo><msup><mi>A</mi><mi>x</mi></msup><mo>+</mo><msup><mi>A</mi><mi>s</mi></msup><mo>+</mo><msup><mi>B</mi><mi>t</mi></msup><mo>+</mo><msup><mi>C</mi><mrow><mi>r</mi><mi>′</mi></mrow></msup><mo>+</mo><msup><mi>C</mi><mi>y</mi></msup><mo>+</mo><msup><mi>C</mi><mi>u</mi></msup></mrow><annotation encoding="application/x-tex">C2=A^{r}+E+C^{r&#39;}=A^r+A^x+A^s+B^t+C^{r&#39;}+C^y+C^u</annotation></semantics></math></p>
<p>復号<br />
アリスは<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>,</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">x,y</annotation></semantics></math>を知っているので以下を計算できる。<br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>=</mo><msup><mi>A</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup><mo>+</mo><mi>C</mi><mn>1</mn><mo>+</mo><msup><mi>C</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup><mo>=</mo><msup><mi>A</mi><mi>s</mi></msup><mo>+</mo><msup><mi>A</mi><mi>x</mi></msup><mo>+</mo><msup><mi>A</mi><mi>r</mi></msup><mo>+</mo><msup><mi>B</mi><mi>t</mi></msup><mo>+</mo><msup><mi>C</mi><mrow><mi>r</mi><mi>′</mi></mrow></msup><mo>+</mo><msup><mi>C</mi><mi>y</mi></msup><mo>+</mo><msup><mi>C</mi><mi>u</mi></msup><mo>=</mo><mi>C</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">X=A^{(x)}+C1+C^{(y)}=A^{s}+A^x+A^r+B^t+C^{r&#39;}+C^y+C^u=C2</annotation></semantics></math></p>
<h2 id="問題">問題</h2>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi><mo>=</mo><msup><mi>A</mi><mi>s</mi></msup><mo>+</mo><msup><mi>B</mi><mi>t</mi></msup><mo>+</mo><msup><mi>C</mi><mi>u</mi></msup></mrow><annotation encoding="application/x-tex">Z=A^s+B^t+C^u</annotation></semantics></math>から<br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><mo>=</mo><mfrac><mrow><msup><mi>p</mi><mrow><mi>s</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>−</mo><mn>1</mn></mrow><mrow><mi>p</mi><mo>−</mo><mn>1</mn></mrow></mfrac><mi>P</mi><mo>+</mo><mfrac><mrow><msup><mi>q</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>−</mo><mn>1</mn></mrow><mrow><mi>q</mi><mo>−</mo><mn>1</mn></mrow></mfrac><mi>Q</mi><mo>+</mo><mfrac><mrow><msup><mi>r</mi><mrow><mi>u</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>−</mo><mn>1</mn></mrow><mrow><mi>r</mi><mo>−</mo><mn>1</mn></mrow></mfrac><mi>R</mi></mrow><annotation encoding="application/x-tex">W=\frac{p^{s-1}-1}{p-1}P+\frac{q^{t-1}-1}{q-1}Q+\frac{r^{u-1}-1}{r-1}R</annotation></semantics></math><br />
を満たすような指数<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo>,</mo><mi>t</mi><mo>,</mo><mi>u</mi></mrow><annotation encoding="application/x-tex">s,t,u</annotation></semantics></math>を求めよ。</p>
<p>例：<br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1575</mn><mo>=</mo><mo stretchy="false" form="prefix">(</mo><msup><mn>7</mn><mi>x</mi></msup><mo>+</mo><msup><mn>11</mn><mi>y</mi></msup><mo>+</mo><msup><mn>13</mn><mi>z</mi></msup><mo stretchy="false" form="postfix">)</mo><mo>mod</mo><mn>2039</mn></mrow><annotation encoding="application/x-tex">1575=(7^x+11^y+13^z) \bmod 2039</annotation></semantics></math><br />
これなら<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>z</mi></mrow><annotation encoding="application/x-tex">x,y,z</annotation></semantics></math>はどうなりますか？</p>
<p>ただし、<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo>,</mo><mi>P</mi><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mi>B</mi><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>q</mi><mo>,</mo><mi>Q</mi><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mi>C</mi><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>r</mi><mo>,</mo><mi>R</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">A=(p,P),B=(q,Q),C=(r,R)</annotation></semantics></math>なる左側要素を素体の元、右側要素を素体上定義された楕円曲線の点であるような半直積とし、<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>B</mi><annotation encoding="application/x-tex">B</annotation></semantics></math>は秘密であるとする。</p>
<h1 id="解読法以下の記事より既出ですが">解読法（以下の記事より既出ですが）</h1>
<p>https://qiita.com/fumumue/items/55b61f63a005f290a2c6</p>
<p>今、加法的多元離散対数問題を解読しようとする。<br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo>,</mo><mi>P</mi><msup><mo stretchy="false" form="postfix">)</mo><mi>s</mi></msup><mo>+</mo><mo stretchy="false" form="prefix">(</mo><mi>q</mi><mo>,</mo><mi>Q</mi><msup><mo stretchy="false" form="postfix">)</mo><mi>t</mi></msup><mo>+</mo><mo stretchy="false" form="prefix">(</mo><mi>r</mi><mo>,</mo><mi>R</mi><msup><mo stretchy="false" form="postfix">)</mo><mi>u</mi></msup><mo>=</mo><mo stretchy="false" form="prefix">(</mo><msup><mi>p</mi><mi>s</mi></msup><mo>+</mo><msup><mi>q</mi><mi>t</mi></msup><mo>+</mo><msup><mi>r</mi><mi>u</mi></msup><mo>,</mo><mfrac><mrow><msup><mi>p</mi><mrow><mi>s</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>−</mo><mn>1</mn></mrow><mrow><mi>p</mi><mo>−</mo><mn>1</mn></mrow></mfrac><mi>P</mi><mo>+</mo><mfrac><mrow><msup><mi>q</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>−</mo><mn>1</mn></mrow><mrow><mi>q</mi><mo>−</mo><mn>1</mn></mrow></mfrac><mi>Q</mi><mo>+</mo><mfrac><mrow><msup><mi>r</mi><mrow><mi>u</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>−</mo><mn>1</mn></mrow><mrow><mi>r</mi><mo>−</mo><mn>1</mn></mrow></mfrac><mi>R</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">D=(p,P)^s+(q,Q)^t+(r,R)^u=(p^s+q^t+r^u,\frac{p^{s-1}-1}{p-1}P+\frac{q^{t-1}-1}{q-1}Q+\frac{r^{u-1}-1}{r-1}R)</annotation></semantics></math></p>
<p>このように書けるところから、異なる原始根に対するべき乗の線形結合が線形代数の手法で簡単に破られるかもしれないという潜在的な危険性がある。つまり<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>,</mo><mi>B</mi><mo>,</mo><mi>C</mi></mrow><annotation encoding="application/x-tex">A,B,C</annotation></semantics></math>に関するベクトル空間があったときに、<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>D</mi><annotation encoding="application/x-tex">D</annotation></semantics></math>が線形独立であるか従属であるかという問題と、ベクトルとして考えたときにガウスの消去法のような手法を使って簡単に解けるかもしれないという可能性です。まあ、隠すべきは冪指数なので係数を求めるような方法では簡単に解けないと思うのですが、それでも例えば<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>A</mi><mi>s</mi></msup><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mi>p</mi><mo>,</mo><mi>P</mi><msup><mo stretchy="false" form="postfix">)</mo><mi>s</mi></msup><mo>=</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">A^s=(p,P)^s=y</annotation></semantics></math>のとき、<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mi>s</mi><mo stretchy="false" form="prefix">(</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false" form="prefix">(</mo><mi>A</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">log(y)=s(log(A))</annotation></semantics></math>として指数<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>s</mi><annotation encoding="application/x-tex">s</annotation></semantics></math>を線形代数の手法で解けるかもしれないという危険性です。いくら加法で誤魔化したつもりでも、代数的構造が線形では単純すぎて簡単に解読できるかもしれないということです。しかし今の時点では、<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>,</mo><mi>B</mi><mo>,</mo><mi>C</mi></mrow><annotation encoding="application/x-tex">A,B,C</annotation></semantics></math>の個々の値は分かっていても、その真数<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>が分からない状態なので、できるかもしれないしできないかもしれない。それは暗号解析に当たって、条件を満たすような暗号文や、選択平文の関係から導き出されるものなので、解読できる可能性が大きいと思います。このように１つの鍵に対する安全性は確立できても、暗号化したデータにはその保証がないというべきでしょう。幸いなのは<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>B</mi><annotation encoding="application/x-tex">B</annotation></semantics></math>が秘密であることです。１つでもわからない値があればLWEのようなエラーが入った多元１次連立多項式の回を計算する問題にうまく関連付けることができるかもしれない。（この辺り何も理解しないで考えているというのがわかります・・・）</p>
<p>今のところは鍵交換に使っていますが、ここで今後公開鍵暗号方式を設計するときに必要なことは、線形代数に気をつけることと、LWE問題のような（未知の値はエラーが入って０になったと考えればいいので）別の問題に帰着できるようにすることです。 （考察中）</p>
<p>section</p>
<h1 id="section">20230623</h1>
<p>MDLPに関する記述に疑問を持って、半直積に加法を定義してみました。<br />
すると魔法のように難しい問題になって６４ビット整数なら４つ秘密指数を知らないと解けない暗号になりました。<br />
実装はまだです。</p>
<p>section-1</p>
<h1 id="section-1">20230620</h1>
<p>楕円曲線の半直積でできた多元離散対数問題に基づく公開鍵暗号と分割問題に基づく暗号（いずれもオリジナル）を実装しました。<br />
名前は、「離散対数とハードボイルドワンダーランド」に決めましたｗ<br />
ec.cppのehw関数がそれです。<br />
この方式は勢いと思いつきで作ったのですが、幸運なことに量子計算機で解読する方法がまだ見つかっていないそうです。</p>
<p>新型暗号はもう出来てるのでec.cppの中に混在しています。<br />
これは謎のようなものですが（エニグマ？）、まだやりたいことがあるのでchatGPTを使って説明を穴埋めしたいと思います。<br />
つまり、MDLPとDecomposition Problemを使った暗号が混在しているということです。<br />
いまは巨大整数ライブラリであるNTLを使っていますが、これもGPTを使ってCのコードに置き換えていきたい。<br />
それともRustがいいのか、C++のままでいいのか・・・（迷ってます）</p>
<p>詳しくは以下のサイトをご覧ください。</p>
<p>https://qiita.com/fumumue/items/5f622ee6ea83cbd4a7f9</p>
<h2 id="行列以外の群に対する鍵交換">行列以外の群に対する鍵交換</h2>
<p>この問題は、私が離散対数でもなく共役元探索問題でもない、非可換群を用いた鍵交換で初めて経験した方法です。<br />
世の中非可換群を使ったプロトコルなんて山のようにあるけど、本当は可換になる部分群を使ってたりしてがっかりすることが多いのですが、そんな偽物ではなく本当に非可換な元同士を組み合わせて鍵交換をしようというのが動機です。<br />
行列を使った暗号は色々攻撃法があって危険かもしれませんが、そのときは半直積にしてお好きな群を非可換にしてみるのも手だと思います。<br />
ちなみに置換群は行列なので解読できる可能性が高いです。<br />
今度記事を書くときには、置換群と数ベクトルの半直積を作って、その弱点を調べたいと思います。<br />
今まで置換群で共役元探索問題をやろうとして線形代数攻撃に悩まされてきたのですが、今度こそその攻撃を交わすことができればいいと思います。<br />
ちなみに行列の３分割問題への攻撃法は先程思いつきましたので、整数行列は絶対に使わないでください。<br />
多変数多項式を要素に持つベクトルと、整数ベクトルの半直積などをやってみたいです。<br />
例えば、１変数多項式をｎ本持つベクトルと、ｎこの整数を持つベクトルとの半直積を考える。<br />
ベクトルを<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mo>,</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">v,x</annotation></semantics></math>、多項式を<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo>,</mo><mi>g</mi></mrow><annotation encoding="application/x-tex">f,g</annotation></semantics></math>とすると<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><mi>v</mi><mo>,</mo><mi>f</mi><mo stretchy="false" form="postfix">)</mo><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>g</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mo stretchy="false" form="prefix">(</mo><msub><mi>f</mi><mi>n</mi></msub><mo stretchy="false" form="prefix">(</mo><msub><mi>x</mi><mi>n</mi></msub><mo stretchy="false" form="postfix">)</mo><mo>+</mo><msub><mi>v</mi><mi>n</mi></msub><mo>,</mo><msub><mi>f</mi><mi>n</mi></msub><msub><mi>g</mi><mi>n</mi></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(v,f)(x,g)=(f_n(x_n)+v_n,f_ng_n)</annotation></semantics></math>（ここで<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi><mi>/</mi><mi>m</mi><mi>Z</mi></mrow><annotation encoding="application/x-tex">Z/mZ</annotation></semantics></math>は整数環,<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">I(x)</annotation></semantics></math>は多項式の法となる既約多項式）のような演算を定義します。</p>
<h1 id="分割問題triple-decomposition-problem">３分割問題（Triple Decomposition Problem）</h1>
<pre><code>定義：(Decomposition Problem)とは  </code></pre>
<p>ある<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mo>=</mo><msub><mi>x</mi><mn>0</mn></msub><msub><mi>x</mi><mn>1</mn></msub><msub><mi>x</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">v = x_0x_1x_2</annotation></semantics></math> と <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mn>1</mn></msub><annotation encoding="application/x-tex">x_1</annotation></semantics></math> が与えられた時、を満たすような<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><msub><mi>x</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">x_1,x_2</annotation></semantics></math>を求める問題です。<br />
ここで、<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>0</mn></msub><mo>,</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><msub><mi>x</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">x_0,x_1,x_2</annotation></semantics></math>は互いに冪等元でないとする。</p>
<p>ここでは3分割のうち1つが公開されている問題になっているはずです。<br />
見た感じ行列を使った暗号によく使われるようです。</p>
<h1 id="鍵設定">鍵設定</h1>
<p>アリスは6個の異なる元を取ります。<br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>,</mo><mi>b</mi><mo>,</mo><mi>c</mi><mo>,</mo><mi>d</mi><mo>,</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>∈</mo><msub><mi>S</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">a,b,c,d,x,y \in S_n</annotation></semantics></math><br />
ボブも同様に６個の元を取ります。<br />
アリスはそのうち<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>,</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">x,y</annotation></semantics></math>だけを公開し、アリスとボブとの間で共有します。<br />
公開する鍵はボブが決めても問題ありません。<br />
つまりボブの秘密鍵は、<br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo>,</mo><mi>f</mi><mo>,</mo><mi>g</mi><mo>,</mo><mi>h</mi><mo>∈</mo><msub><mi>S</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">e,f,g,h \in S_n</annotation></semantics></math><br />
の４つだけです。</p>
<p>アリスは次のようにして公開鍵を作ります。<br />
まず<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>d</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>a</mi><mo>=</mo><mi>h</mi><msup><mi>′</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>e</mi><mo>=</mo><mi>ϕ</mi></mrow><annotation encoding="application/x-tex">d^{-1}a=h&#39;^{-1}e=\phi</annotation></semantics></math>であるように決めます。<br />
これは後で述べるビットパターンの分離記号としての役割を果たす元です。</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mn>1</mn><mo>=</mo><mo stretchy="false" form="prefix">(</mo><msub><mi>a</mi><mn>1</mn></msub><mo>=</mo><mi>a</mi><mi>x</mi><mi>b</mi><mo>,</mo><msub><mi>a</mi><mn>2</mn></msub><mo>=</mo><msup><mi>b</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>x</mi><mi>c</mi><mo>,</mo><msub><mi>a</mi><mn>3</mn></msub><mo>=</mo><msup><mi>c</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>x</mi><msup><mi>d</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">A1=(a_1=axb,a_2=b^{-1}xc,a_3=c^{-1}xd^{-1})</annotation></semantics></math><br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mn>2</mn><mo>=</mo><mo stretchy="false" form="prefix">(</mo><msub><mi>b</mi><mn>1</mn></msub><mo>=</mo><mi>a</mi><mi>y</mi><mi>b</mi><mo>,</mo><msub><mi>b</mi><mn>2</mn></msub><mo>=</mo><msup><mi>b</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>y</mi><mi>c</mi><mo>,</mo><msub><mi>b</mi><mn>3</mn></msub><mo>=</mo><msup><mi>c</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>y</mi><msup><mi>d</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">A2=(b_1=ayb,b_2=b^{-1}yc,b_3=c^{-1}yd^{-1})</annotation></semantics></math></p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mn>1</mn><mo>=</mo><mo stretchy="false" form="prefix">(</mo><msub><mi>c</mi><mn>1</mn></msub><mo>=</mo><mi>e</mi><mi>x</mi><mi>f</mi><mo>,</mo><msub><mi>c</mi><mn>2</mn></msub><mo>=</mo><msup><mi>f</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>x</mi><mi>g</mi><mo>,</mo><msub><mi>c</mi><mn>3</mn></msub><mo>=</mo><msup><mi>g</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>x</mi><mi>h</mi><msup><mi>′</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">B1=(c_1=exf,c_2=f^{-1}xg,c_3=g^{-1}xh&#39;^{-1})</annotation></semantics></math><br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mn>2</mn><mo>=</mo><mo stretchy="false" form="prefix">(</mo><msub><mi>d</mi><mn>1</mn></msub><mo>=</mo><mi>e</mi><mi>y</mi><mi>f</mi><mo>,</mo><msub><mi>d</mi><mn>2</mn></msub><mo>=</mo><msup><mi>f</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>y</mi><mi>g</mi><mo>,</mo><msub><mi>d</mi><mn>3</mn></msub><mo>=</mo><msup><mi>g</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>y</mi><mi>h</mi><msup><mi>′</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">B2=(d_1=eyf,d_2=f^{-1}yg,d_3=g^{-1}y h&#39;^{-1})</annotation></semantics></math></p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mn>1</mn><mo>,</mo><mi>A</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">A1,A2</annotation></semantics></math>はアリスの公開鍵、<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mn>1</mn><mo>,</mo><mi>B</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">B1,B2</annotation></semantics></math>がボブの公開鍵、<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>,</mo><mi>b</mi><mo>,</mo><mi>c</mi><mo>,</mo><mi>d</mi></mrow><annotation encoding="application/x-tex">a,b,c,d</annotation></semantics></math>がアリスの秘密鍵、<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo>,</mo><mi>f</mi><mo>,</mo><mi>g</mi><mo>,</mo><mi>h</mi><mi>′</mi></mrow><annotation encoding="application/x-tex">e,f,g,h&#39;</annotation></semantics></math>がボブの秘密鍵です。</p>
<h1 id="ビットパターンと鍵共有">ビットパターンと鍵共有</h1>
<p>（ややこしいのでじっくり読みましょうｗ）</p>
<p>ここで1つ制約条件をつけます。<br />
それはアリスとボブの秘密のバイナリ列の長さが偶数であるという仮定です。<br />
その仮定のもとにこの鍵交換は成り立ちます。<br />
ビットパターンを<br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mi>i</mi><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mi>j</mi><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mi>k</mi><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">h=(0,0),i=(0,1),j=(1,0),k=(1,1)</annotation></semantics></math>とします。<br />
長さ2のバイナリ列にはこの4パターンしかないので、これだけ定義できれば十分です。</p>
<p>この時、各2ビット列が、アリストボブの間でどのように組み合わせられるのか見ていきます。<br />
まず、パターンhのとき、アリスの鍵の組み合わせは、<br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mo>=</mo><msub><mi>a</mi><mn>1</mn></msub><msub><mi>a</mi><mn>2</mn></msub><msub><mi>a</mi><mn>3</mn></msub><mo>=</mo><mi>a</mi><msup><mi>x</mi><mn>3</mn></msup><msup><mi>d</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">h=a_1a_2a_3=ax^3d^{-1}</annotation></semantics></math>と決めます。<br />
同様にパターンiの場合は、<br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>=</mo><msub><mi>a</mi><mn>1</mn></msub><msub><mi>b</mi><mn>2</mn></msub><msub><mi>a</mi><mn>3</mn></msub><mo>=</mo><mi>a</mi><mi>x</mi><mi>y</mi><mi>x</mi><msup><mi>d</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">i=a_1b_2a_3=axyxd^{-1}</annotation></semantics></math><br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>=</mo><msub><mi>b</mi><mn>1</mn></msub><msub><mi>a</mi><mn>2</mn></msub><msub><mi>b</mi><mn>3</mn></msub><mo>=</mo><mi>a</mi><mi>y</mi><mi>x</mi><mi>y</mi><msup><mi>d</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">j=b_1a_2b_3=ayxyd^{-1}</annotation></semantics></math><br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><msub><mi>b</mi><mn>1</mn></msub><msub><mi>b</mi><mn>2</mn></msub><msub><mi>b</mi><mn>3</mn></msub><mo>=</mo><mi>a</mi><msup><mi>y</mi><mn>3</mn></msup><msup><mi>d</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">k=b_1b_2b_3=ay^3d^{-1}</annotation></semantics></math></p>
<p>となるように決めます。<br />
同様にボブも、<br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mn>1</mn><mo>=</mo><msub><mi>c</mi><mn>1</mn></msub><msub><mi>c</mi><mn>2</mn></msub><msub><mi>c</mi><mn>3</mn></msub><mo>=</mo><mi>e</mi><msup><mi>x</mi><mn>3</mn></msup><mi>h</mi><msup><mi>′</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">h1=c_1c_2c_3=ex^3h&#39;^{-1}</annotation></semantics></math>と決めます。<br />
同様にパターンiの場合は、<br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mn>1</mn><mo>=</mo><msub><mi>c</mi><mn>1</mn></msub><msub><mi>d</mi><mn>2</mn></msub><msub><mi>c</mi><mn>3</mn></msub><mo>=</mo><mi>e</mi><mi>x</mi><mi>y</mi><mi>x</mi><mi>h</mi><msup><mi>′</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">i1=c_1d_2c_3=exyxh&#39;^{-1}</annotation></semantics></math><br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mn>1</mn><mo>=</mo><msub><mi>d</mi><mn>1</mn></msub><msub><mi>c</mi><mn>2</mn></msub><msub><mi>d</mi><mn>3</mn></msub><mo>=</mo><mi>e</mi><mi>y</mi><mi>x</mi><mi>y</mi><mi>h</mi><msup><mi>′</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">j1=d_1c_2d_3=eyxyh&#39;^{-1}</annotation></semantics></math><br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mn>1</mn><mo>=</mo><msub><mi>d</mi><mn>1</mn></msub><msub><mi>d</mi><mn>2</mn></msub><msub><mi>d</mi><mn>3</mn></msub><mo>=</mo><mi>e</mi><msup><mi>y</mi><mn>3</mn></msup><mi>h</mi><msup><mi>′</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">k1=d_1d_2d_3=ey^3h&#39;^{-1}</annotation></semantics></math></p>
<p>これは行ってしまえば、０と１を2つの元の対応関係で表現しているということです。<br />
3つの異なる元を組み合わせると同時に、ビット列を共有したいという要求を実現できます。</p>
<p>ここで<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>d</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>a</mi><mo>=</mo><msup><mi>h</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>e</mi><mo>=</mo><mi>ϕ</mi></mrow><annotation encoding="application/x-tex">d^{-1}a=h^{-1}e=\phi</annotation></semantics></math>と決めた事を思い出してください。<br />
あとはパターン通りに鍵の組み合わせを並べるだけです。</p>
<p>アリスのビットパターンが1010のときは、<br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><msub><mi>a</mi><mn>1</mn></msub></msub><mo>=</mo><mi>j</mi><mi>j</mi><mo>=</mo><msub><mi>b</mi><mn>1</mn></msub><msub><mi>a</mi><mn>2</mn></msub><msub><mi>b</mi><mn>3</mn></msub><msub><mi>b</mi><mn>1</mn></msub><msub><mi>a</mi><mn>2</mn></msub><msub><mi>b</mi><mn>3</mn></msub><mo>=</mo><mi>a</mi><mi>y</mi><mi>x</mi><mi>y</mi><mi>ϕ</mi><mi>y</mi><mi>x</mi><mi>y</mi><msup><mi>d</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">K_{a_1}=jj=b_1a_2b_3b_1a_2b_3=ayxy\phi yxyd^{-1}</annotation></semantics></math><br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><msub><mi>a</mi><mn>2</mn></msub></msub><mo>=</mo><mi>j</mi><mn>1</mn><mi>j</mi><mn>1</mn><mo>=</mo><msub><mi>c</mi><mn>1</mn></msub><msub><mi>d</mi><mn>2</mn></msub><msub><mi>c</mi><mn>1</mn></msub><msub><mi>b</mi><mn>1</mn></msub><msub><mi>d</mi><mn>2</mn></msub><msub><mi>b</mi><mn>3</mn></msub><mo>=</mo><mi>e</mi><mi>y</mi><mi>x</mi><mi>y</mi><mi>ϕ</mi><mi>y</mi><mi>x</mi><mi>y</mi><mi>h</mi><msup><mi>′</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">K_{a_2}=j1j1=c_1d_2c_1b_1d_2b_3=eyxy\phi yxyh&#39;^{-1}</annotation></semantics></math><br />
1111の場合は、<br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><msub><mi>b</mi><mn>1</mn></msub></msub><mo>=</mo><mi>k</mi><mi>k</mi><mo>=</mo><msub><mi>b</mi><mn>1</mn></msub><msub><mi>b</mi><mn>2</mn></msub><msub><mi>b</mi><mn>3</mn></msub><msub><mi>b</mi><mn>1</mn></msub><msub><mi>b</mi><mn>2</mn></msub><msub><mi>b</mi><mn>3</mn></msub><mo>=</mo><mi>a</mi><msup><mi>y</mi><mn>3</mn></msup><mi>ϕ</mi><msup><mi>y</mi><mn>3</mn></msup><msup><mi>d</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">K_{b_1}=kk=b_1b_2b_3b_1b_2b_3=ay^3\phi y^3d^{-1}</annotation></semantics></math><br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><msub><mi>b</mi><mn>2</mn></msub></msub><mo>=</mo><mi>k</mi><mn>1</mn><mi>k</mi><mn>1</mn><mo>=</mo><mi>e</mi><msup><mi>y</mi><mn>3</mn></msup><mi>ϕ</mi><msup><mi>y</mi><mn>3</mn></msup><mi>h</mi><msup><mi>′</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">K_{b_2}=k1k1=ey^3\phi y^3h&#39;^{-1}</annotation></semantics></math></p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mrow><mi>a</mi><mi>l</mi><mi>i</mi><mi>c</mi><mi>e</mi></mrow></msub><mo>=</mo><msub><mi>K</mi><msub><mi>a</mi><mn>1</mn></msub></msub><msub><mi>K</mi><msub><mi>b</mi><mn>1</mn></msub></msub><mo>=</mo><mi>a</mi><mi>y</mi><mi>x</mi><mi>y</mi><mi>ϕ</mi><mi>y</mi><mi>x</mi><msup><mi>y</mi><mn>4</mn></msup><mi>ϕ</mi><msup><mi>y</mi><mn>3</mn></msup><msup><mi>d</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">K_{alice}=K_{a_1}K_{b_1}=ayxy\phi yxy^4\phi y^3d^{-1}</annotation></semantics></math><br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mrow><mi>b</mi><mi>o</mi><mi>b</mi></mrow></msub><mo>=</mo><msub><mi>K</mi><msub><mi>a</mi><mn>2</mn></msub></msub><msub><mi>K</mi><msub><mi>b</mi><mn>2</mn></msub></msub><mo>=</mo><mi>e</mi><mi>y</mi><mi>x</mi><mi>y</mi><mi>ϕ</mi><mi>y</mi><mi>x</mi><msup><mi>y</mi><mn>4</mn></msup><mi>ϕ</mi><msup><mi>y</mi><mn>3</mn></msup><mi>h</mi><msup><mi>′</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">K_{bob}=K_{a_2}K_{b_2}=eyxy\phi yxy^4\phi y^3h&#39;^{-1}</annotation></semantics></math></p>
<p>であり、鍵に割り当てられた番号同士をつなぎ合わせて、<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mrow><mi>a</mi><mi>l</mi><mi>i</mi><mi>c</mi><mi>e</mi></mrow></msub><mo>,</mo><msub><mi>K</mi><mrow><mi>b</mi><mi>o</mi><mi>b</mi></mrow></msub></mrow><annotation encoding="application/x-tex">K_{alice},K_{bob}</annotation></semantics></math>からそれぞれアリスとボブの秘密鍵を取り除けば鍵共有は出来上がりです。<br />
これは非可換でなければならないという要請に答えるための鍵共有ができる元の3分割問題(triple decomposition problem)を利用したものとなると思います。（不安）</p>
<p>ここで問題が。<br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ϕ</mi><annotation encoding="application/x-tex">\phi</annotation></semantics></math>が公開されることで、特定の位置に<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ϕ</mi><annotation encoding="application/x-tex">\phi</annotation></semantics></math>があることがわかるというのはどの程度問題になるだろうか？<br />
かと言って1にしてしまうと3つのパーツを全部揃えれば線形代数攻撃に弱くなるし、何かいい方法があるかもう少し考えます。</p>
<p>成功したら大発見です。</p>
<p>以下の記事の続きです。<br />
オリジナルバージョンの公開鍵暗号を使ってシュノア署名を実現します。</p>
<p>https://qiita.com/fumumue/items/5f622ee6ea83cbd4a7f9</p>
<p>ここで言う非可換群を、楕円曲線の点群を要素に持つに持つ半直積と呼ぶことにする。<br />
半直積については上記アドレスに書いてあります。</p>
<h1 id="鍵の設定">鍵の設定</h1>
<p>公開鍵：<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mo>=</mo><msup><mi>A</mi><mi>x</mi></msup><mi>B</mi><msup><mi>C</mi><mi>y</mi></msup><mo>,</mo><mi>E</mi><mo>=</mo><msup><mi>A</mi><mi>z</mi></msup><mi>B</mi><msup><mi>C</mi><mi>w</mi></msup><mo>,</mo><mi>A</mi><mo>,</mo><mi>C</mi></mrow><annotation encoding="application/x-tex">D=A^xBC^y,E=A^zBC^w,A,C</annotation></semantics></math><br />
秘密鍵：<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo>,</mo><mi>w</mi><mo>,</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">x,y,z,w,B</annotation></semantics></math></p>
<h1 id="署名作成">署名作成</h1>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo>=</mo><mi>D</mi><msup><mi>E</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>=</mo><msup><mi>A</mi><mi>x</mi></msup><mi>B</mi><msup><mi>C</mi><mrow><mo stretchy="false" form="prefix">(</mo><mi>y</mi><mo>−</mo><mi>w</mi><mo stretchy="false" form="postfix">)</mo></mrow></msup><msup><mi>B</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><msup><mi>A</mi><mrow><mo>−</mo><mi>z</mi></mrow></msup><mo>=</mo><msup><mi>A</mi><mi>x</mi></msup><mi>Q</mi><msup><mi>A</mi><mrow><mo>−</mo><mi>z</mi></mrow></msup></mrow><annotation encoding="application/x-tex">P=DE^{-1}=A^xBC^{(y-w)}B^{-1}A^{-z}=A^xQA^{-z}</annotation></semantics></math><br />
と置く。<br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>,</mo><mi>r</mi><mi>′</mi></mrow><annotation encoding="application/x-tex">r,r&#39;</annotation></semantics></math>を乱数とし、次を計算する。<br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo>=</mo><mi>H</mi><mo stretchy="false" form="prefix">(</mo><mi>m</mi><mo stretchy="false" form="prefix">|</mo><mo stretchy="false" form="prefix">|</mo><msup><mi>A</mi><mi>r</mi></msup><mi>Q</mi><msup><mi>A</mi><mrow><mi>r</mi><mi>′</mi></mrow></msup><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">e=H(m||A^rQA^{r&#39;})</annotation></semantics></math><br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mn>1</mn></msub><mo>=</mo><mi>r</mi><mo>−</mo><mi>x</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">y_1=r-xe</annotation></semantics></math><br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mn>2</mn></msub><mo>=</mo><mi>r</mi><mi>′</mi><mo>+</mo><mi>z</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">y_2=r&#39;+ze</annotation></semantics></math></p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>i</mi><mi>g</mi><mo>=</mo><mo stretchy="false" form="prefix">(</mo><msub><mi>y</mi><mn>1</mn></msub><mo>,</mo><msub><mi>y</mi><mn>2</mn></msub><mo>,</mo><mi>e</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">sig=(y_1,y_2,e)</annotation></semantics></math></p>
<h1 id="署名検証">署名検証</h1>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo>=</mo><msup><mi>A</mi><mi>x</mi></msup><mi>Q</mi><msup><mi>A</mi><mrow><mo>−</mo><mi>z</mi></mrow></msup></mrow><annotation encoding="application/x-tex">P=A^xQA^{-z}</annotation></semantics></math><br />
なので、<br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mo>=</mo><msup><mi>A</mi><msub><mi>y</mi><mn>1</mn></msub></msup><msup><mi>A</mi><mi>e</mi></msup><mi>P</mi><msup><mi>A</mi><msub><mi>y</mi><mn>2</mn></msub></msup><msup><mi>A</mi><mi>e</mi></msup><mo>=</mo><msup><mi>A</mi><mrow><mi>r</mi><mo>−</mo><mi>e</mi><mi>x</mi></mrow></msup><msup><mi>A</mi><mi>e</mi></msup><mi>P</mi><msup><mi>A</mi><mrow><mi>r</mi><mi>′</mi><mo>−</mo><mi>z</mi><mi>e</mi></mrow></msup><msup><mi>A</mi><mi>e</mi></msup><mo>=</mo><msup><mi>A</mi><mrow><mi>r</mi><mo>−</mo><mi>e</mi><mi>x</mi></mrow></msup><msup><mi>A</mi><mi>e</mi></msup><mo stretchy="false" form="prefix">(</mo><msup><mi>A</mi><mi>x</mi></msup><mi>Q</mi><msup><mi>A</mi><mrow><mo>−</mo><mi>z</mi></mrow></msup><mo stretchy="false" form="postfix">)</mo><msup><mi>A</mi><mi>e</mi></msup><msup><mi>A</mi><mrow><mi>r</mi><mi>′</mi><mo>+</mo><mi>z</mi><mi>e</mi></mrow></msup><mo>=</mo><msup><mi>A</mi><mi>r</mi></msup><mi>Q</mi><msup><mi>A</mi><mrow><mi>r</mi><mi>′</mi></mrow></msup></mrow><annotation encoding="application/x-tex">c=A^{y_1}A^{e}PA^{y_2}A^{e}=A^{r-ex}A^{e}PA^{r&#39;-ze}A^{e}=A^{r-ex}A^{e}(A^xQA^{-z})A^{e}A^{r&#39;+ze}=A^rQA^{r&#39;}</annotation></semantics></math><br />
と置くと、<br />
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mi>′</mi><mo>=</mo><mi>H</mi><mo stretchy="false" form="prefix">(</mo><mi>m</mi><mo stretchy="false" form="prefix">|</mo><mo stretchy="false" form="prefix">|</mo><mi>c</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">e&#39;=H(m||c)</annotation></semantics></math><br />
もし、<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo>=</mo><mi>e</mi><mi>′</mi></mrow><annotation encoding="application/x-tex">e=e&#39;</annotation></semantics></math>なら正しい署名である。</p>
<p>この暗号自体がエルガマル暗号のような離散対数問題と、群の元を3つに分解する分解問題の合体のようなものなので、どちらの問題の困難性に基づいているのかはまだ明らかではない。<br />
ところで、RSAが鍵を大きくすることで生き残れるとしたら、ECDLPもそうなるはずで、どちらも一時しのぎに過ぎないかもしれないけど、今から楕円曲線やペアリングを始める価値も十分にある。暗号の応用としては、私は決定不可能性を用いた暗号（要するに計算機には解けない）や、非可換群を用いた暗号でIBE（IDベース暗号）などが作れればいいのにと思っている。 でも今回、非可換群を使うことでエルガマル型の電子署名ができたので、他の応用にも使えるのではないかと期待している。</p>
<h1 id="参考文献">参考文献</h1>
<h1 id="付録プログラム">付録：プログラム</h1>
</body>
</html>
